<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="JustBedwars.Views.GuildLookupResultPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:JustBedwars.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:media="using:CommunityToolkit.WinUI.Media"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:animations="using:CommunityToolkit.WinUI.Animations"
    mc:Ignorable="d">

    <Grid>
        
        <ScrollView>
            <StackPanel>
                <!-- Top Title Bar -->
                <Grid Padding="16,16,16,0" Height="150" x:Name="TopBar" Visibility="Collapsed">
                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.5" From="0,-100,0" To="0"/>
                        <animations:OpacityAnimation Duration="0:0:0.5" From="0" To="1"/>
                    </animations:Implicit.ShowAnimations>
                    <Grid Background="{ThemeResource SystemFillColorAttentionBackgroundBrush}"
                          CornerRadius="{ThemeResource OverlayCornerRadius}"
                          BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}">
                        <TextBlock x:Name="GuildNameTextBlock" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                   Text="Guild Name"
                                   FontSize="28"
                                   FontWeight="Bold"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"/>
                    </Grid>
                    <Grid Background="{ThemeResource SystemFillColorAttentionBackgroundBrush}"
                          CornerRadius="{ThemeResource OverlayCornerRadius}"
                          BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                          VerticalAlignment="Bottom"
                          HorizontalAlignment="Left"
                          Padding="16,12"
                          Margin="8,0,0,8">
                        <TextBlock x:Name="GuildTagTextBlock" Text="TAG" FontSize="16" FontWeight="Medium"/>
                    </Grid>
                </Grid>
                <SelectorBar x:Name="SelectorBar" SelectionChanged="SelectorBar_SelectionChanged" Visibility="Collapsed" Margin="10,0">
                    <SelectorBarItem x:Name="InfoSelector" Text="Info" IsSelected="True"/>
                    <SelectorBarItem x:Name="PlayersSelector" Text="Players"/>
                    <SelectorBarItem x:Name="RanksSelector" Text="Ranks"/>
                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.5" From="0,-100,0" To="0"/>
                        <animations:OpacityAnimation Duration="0:0:0.5" From="0" To="1"/>
                    </animations:Implicit.ShowAnimations>
                </SelectorBar>

                <Grid x:Name="InfoView" Visibility="Collapsed">
                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.3" Delay="0:0:0.2" From="0,40,0" To="0"/>
                        <animations:OpacityAnimation Duration="0:0:0.3" Delay="0:0:0.2" From="0" To="1" />
                    </animations:Implicit.ShowAnimations>
                    <animations:Implicit.HideAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.3" From="0" To="0,40,0"/>
                        <animations:OpacityAnimation Duration="0:0:0.3" From="1" To="0" />
                    </animations:Implicit.HideAnimations>
                    <Grid Padding="12" ColumnSpacing="10" RowSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Grid.Column="0" Padding="10">
                            <TextBlock Text="Description" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="DescriptionTextBlock" TextWrapping="Wrap" Text="No description available." IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <StackPanel Grid.Row="0" Grid.Column="1" Padding="10">
                            <TextBlock Text="Preferred Games" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="PreferredGamesTextBlock" Text="Not set." IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="0" Padding="10">
                            <TextBlock Text="Level" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="LevelTextBlock" IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="1" Padding="10">
                            <TextBlock Text="Experience" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="ExpTextBlock" IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <!-- Nevermind doesn't work -->
                        <StackPanel Grid.Row="1" Grid.Column="2" Padding="10" Visibility="Collapsed">
                            <TextBlock Text="Online Players" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="OnlinePlayersTextBlock" Text="N/A"/>
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="0" Padding="10">
                            <TextBlock Text="Created At" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="CreatedAtTextBlock" IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="1" Padding="10">
                            <TextBlock Text="Guild ID" FontWeight="Bold" FontSize="18"/>
                            <TextBlock x:Name="GuildIdTextBlock" TextWrapping="Wrap" IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="3" Padding="10">
                            <Expander Width="800">
                                <ListView x:Name="ExpByGameTypeListView" Width="700" SelectionMode="None">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Width="700">
                                                <TextBlock Text="{Binding Key}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding Value}" HorizontalAlignment="Stretch" TextAlignment="Right" Margin="0,0,29,0"/>
                                                
                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                                <Expander.Header>
                                    <TextBlock Text="Experience by Game" FontWeight="Bold" FontSize="18"/>
                                </Expander.Header>
                            </Expander>
                        </StackPanel>
                    </Grid>
                </Grid>

                <Grid x:Name="PlayersView" Visibility="Collapsed">
                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.3" Delay="0:0:0.2" From="0,40,0" To="0"/>
                        <animations:OpacityAnimation Duration="0:0:0.3" Delay="0:0:0.2" From="0" To="1" />
                    </animations:Implicit.ShowAnimations>
                    <animations:Implicit.HideAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.3" From="0" To="0,40,0"/>
                        <animations:OpacityAnimation Duration="0:0:0.3" From="1" To="0" />
                    </animations:Implicit.HideAnimations>
                    <!-- Player List -->
                    <StackPanel>
                        <!-- Filters for Players List -->
                        <controls:Segmented x:Name="RankFilter" SelectionChanged="RankFilter_SelectionChanged" Margin="16,8">
                            <!-- Populate in code with guild ranks -->
                        </controls:Segmented>

                        <ListView x:Name="MembersListView" IsItemClickEnabled="True" ItemClick="MembersListView_ItemClick">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                        <TextBlock Text="{Binding Rank}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Grid>

                <Grid x:Name="RanksView" Visibility="Collapsed">
                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.3" Delay="0:0:0.2" From="0,40,0" To="0"/>
                        <animations:OpacityAnimation Duration="0:0:0.3" Delay="0:0:0.2" From="0" To="1" />
                    </animations:Implicit.ShowAnimations>
                    <animations:Implicit.HideAnimations>
                        <animations:TranslationAnimation Duration="0:0:0.3" From="0" To="0,40,0"/>
                        <animations:OpacityAnimation Duration="0:0:0.3" From="1" To="0" />
                    </animations:Implicit.HideAnimations>
                    <!-- Guild Rank list -->
                    <ListView x:Name="RanksListView" IsItemClickEnabled="True" ItemClick="RanksListView_ItemClick">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Tag}"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </StackPanel>
        </ScrollView>


        <Grid x:Name="ErrorGrid" Visibility="Collapsed" VerticalAlignment="Center" HorizontalAlignment="Center"
              Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
              CornerRadius="{ThemeResource OverlayCornerRadius}"
              BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}">
            <animations:Implicit.ShowAnimations>
                <animations:TranslationAnimation Duration="0:0:1" From="0,0,60" To="0"/>
                <animations:OpacityAnimation Duration="0:0:0.7" From="0" To="1" />
            </animations:Implicit.ShowAnimations>
            <StackPanel Spacing="16" Padding="16">
                <TextBlock Text="A Error has occured."
                           FontSize="17"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center"/>
                <TextBlock Text="The Guild couldn't be loaded"
                           FontSize="14"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           VerticalAlignment="Center"/>
                <Button Content="Go Back"
                        Click="GoBackButton_Click"
                        />
            </StackPanel>
        </Grid>


        <Grid Canvas.ZIndex="12" x:Name="LoadingOverlay">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="12">
                <ProgressRing x:Name="LoadingProgressRing" IsActive="True"/>
                <StackPanel x:Name="LoadingDetails" Visibility="Collapsed">
                    <TextBlock x:Name="LoadingStatus" Text="Downloading Player Data..." HorizontalAlignment="Center"/>
                    <ProgressBar x:Name="LoadingProgressBar" Width="200" Margin="0,8,0,0"/>
                    <TextBlock x:Name="LoadingPercentage" Text="0%" HorizontalAlignment="Center"/>
                </StackPanel>
            </StackPanel>
        </Grid>

        <AppBarButton Icon="Back"
                      Click="GoBackButton_Click"
                      VerticalAlignment="Top"
                      HorizontalAlignment="Left"
                      Margin="10" IsCompact="True" Width="50">
            <animations:Implicit.ShowAnimations>
                <animations:TranslationAnimation Duration="0:0:1" From="-125,0,0" To="0,0,0"/>
            </animations:Implicit.ShowAnimations>
        </AppBarButton>
    </Grid>
</Page>
